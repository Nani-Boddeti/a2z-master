<div class="details-header">
  <h2>Ad Details</h2>
</div>
    <div class="error-banner" *ngIf="showError" role="alert">
        <div class="error-icon">⚠️</div>
           <div class="error-text">         
          {{ errorMessage }}
        </div>
        <button 
          class="error-close" 
          (click)="closeError()"
          aria-label="Dismiss">
          <svg width="14" height="14" viewBox="0 0 14 14">
            <path d="M1 1 L13 13 M13 1 L1 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
</div>


<div class="details-container">
  <div *ngIf="isItemSelected && !isBackToAllPosts && !isOrderPlaced">
    <!-- SAME 3-COLUMN STRUCTURE AS APPROVAL -->
    <div class="details-card">
      <!-- LEFT 20%: Image -->
      <div class="details-image-cell">
        <div
          class="image-carousel"
          *ngIf="selectedItem?.mediaContainerData?.medias"
          style="position: relative; overflow: hidden"
        >
          <!-- Carousel Track -->
          <div
            class="carousel-track"
            [style.transform]="'translateX(-' + currentIndex * 100 + '%)'"
            style="
              display: flex;
              transition: transform 0.3s ease;
              height: 300px;
            "
          >
            @for (
              media of selectedItem.mediaContainerData.medias;
              track $index
            ) {
              <div
                class="carousel-slide"
                style="min-width: 100%; box-sizing: border-box"
              >
                <img
                  [src]="
                    '/uploads/' +
                    selectedItem.mediaContainerData.code +
                    '/' +
                    media.fileName
                  "
                  [alt]="'Product image ' + $index"
                  style="width: 100%; height: 100%; object-fit: cover"
                  loading="lazy"
                />
              </div>
            }
          </div>

          <!-- Navigation Dots -->
          @if (selectedItem.mediaContainerData.medias.length > 1) {
            <div
              class="carousel-dots"
              style="text-align: center; margin-top: 15px; gap: 8px"
            >
              @for (
                dot of selectedItem.mediaContainerData.medias;
                track $index
              ) {
                <button
                  class="carousel-dot"
                  type="button"
                  [class.active]="currentIndex === $index"
                  (click)="currentIndex = $index"
                  [style.background]="
                    currentIndex === $index ? '#007bff' : '#ddd'
                  "
                  style="
                    border: none;
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: background 0.2s;
                  "
                ></button>
              }
            </div>
          }
        </div>
      </div>

      <!-- MIDDLE 50%: Info -->
      <div class="details-info-cell">
        <h3>{{ selectedItem?.productName }}</h3>
        <p class="product-description">{{ selectedItem?.description }}</p>
        <div class="location-display">
          <button
            class="rent-btn"
            (click)="openMap(selectedItem?.latitude, selectedItem?.longitude)"
          >
            Open Map
          </button>

          <span class="location"
            >{{ selectedItem?.latitude }}, {{ selectedItem?.longitude }}</span
          >
        </div>
        <div class="address-display"></div>
      </div>

      <!-- RIGHT 30%: Price + Actions -->
      <div class="details-price-cell">
        <div class="price-display">
          <span class="price"
            >{{ selectedItem?.price?.currency }}
            {{ selectedItem?.price?.amount }}</span
          >          
        </div>
          <div><span class="product-description" *ngIf="selectedItem?.orderType==='RENTAL'"
            >Rental Per Day!</span></div>
        <div class="action-buttons">
          <button (click)="backToList()" class="back-btn">Back to List</button>
          <button (click)="rentIt(selectedItem)"  class="rent-btn" *ngIf="!selectedItem?.isSelfAd">
            {{submitButtonName}}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
