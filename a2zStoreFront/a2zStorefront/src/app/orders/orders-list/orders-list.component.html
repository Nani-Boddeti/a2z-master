
<div class="container mx-auto px-4 py-8 max-w-6xl">
  <!-- Orders Header -->
  <div class="content mb-12 p-8">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Order History</h1>
        <p class="text-gray-700">Track and manage all your recent orders</p>
      </div>
     
        <!-- <div class="search-bar">
          <input type="text" placeholder="Search orders..." class="search-input">
          <button class="btn">Search</button>
        </div> -->
      
    </div>

    <!-- Filters -->
  <div class="filters pill-group">
  <!-- Filter Buttons (Track selected filter) -->
  <button class="pill" 
          [class.active]="selectedStatus === filter"
          (click)="getOrdersByStatus(currentPage, filter)"
          *ngFor="let filter of orderStatusList">
    {{filter}}
  </button>
</div>
  </div>
@for (order of orderList; track $index) {
  <!-- Orders Grid -->
      <div class="article-grid">
      <!-- 3-Column Order Card -->
      <div class="order-card-three-col article-card">
        
        <!-- LEFT COLUMN: Header + Image (35%) -->
        <div class="order-left-section">
          <div class="order-header-compact">
            <div class="flex items-start gap-2">
              <span class="order-id">{{order?.id}}</span><br>
              <span class="order-id" *ngIf="order?.originalOrderId"> Original Order ID:{{order?.originalOrderId}}</span><br>
              <span class="status-badge delivered">{{order?.status}}</span>
            </div>
            <span class="order-date">{{order?.date}}</span>
          </div>
          <div class="image-carousel" style="position: relative; overflow: hidden">
          <!-- Image Carousel -->
           <div class="carousel-track"  style="
              display: flex;
              transition: transform 0.3s ease;
              height: 300px;
            ">

              @for (ad of order?.entries;track $index){
          @for (media of ad.adPost?.mediaContainerData?.medias; track $index){
            <div class="carousel-slide"  style="min-width: 100%; box-sizing: border-box">
            <img src="/uploads/{{ad.adPost?.mediaContainerData?.code}}/{{media?.fileName}}" 
                  class="order-image">
          </div>
        }
        }
           </div>

          </div>
          
        </div>
        
        <!-- MIDDLE COLUMN: Items + Description (45%) -->
        <div class="order-middle-section">
          <div class="order-items-preview">
            <div class="order-item-mini">
              @for (ad of order?.entries;track $index){
              <div>
                <h4 class="mini-item-title">{{ad?.adPost?.productName}}</h4>
                <p class="mini-item-qty">Qty: 1</p>
                <span class="mini-item-desc item-details-mini" *ngIf="order?.status==='APPROVED'">
            Owner : {{ad?.adPost?.customer?.firstName}}<br>
            {{ad?.adPost?.sourceAddress?.line1}},{{ad?.adPost?.sourceAddress?.line2}}, {{ad?.adPost?.sourceAddress?.city}}<br>
            Mobile:  {{ad?.adPost?.customer?.phoneNumber}}<br>
            <button
            class="ord-btn"
            (click)="openMap(ad?.adPost?.sourceAddress?.latitude, ad?.adPost?.sourceAddress?.longitude)"
          >
            Open Map
          </button>
          </span>
              </div>}
            </div>
          </div>
          
        </div>
        
        <!-- RIGHT COLUMN: Price + Actions (20%) -->
        <div class="order-right-section">
          <div class="total-price-large">{{order?.price?.amount}}</div>
          <button class="ord-btn" *ngIf="order.eligibleToExtend" (click)="OnSubmitExtendOrder(order.id)">Extend</button>
          <button class="ord-btn" *ngIf="order.returnable" (click)="OnSubmitReturnOrder(order.id)">Return</button>
          <button class="ord-btn" *ngIf="order.eligibleToCancel">Cancel</button>
          <div class="order-actions">
            <a href="/order/1245" class="view-details">View →</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Child Orders Loop -->
      <div class="child-order-container">
            @for (childOrder of order.childOrders; track $index) {
          <!-- Orders Grid -->
              <div class="article-grid">
              <!-- 3-Column Order Card -->
              <div class="child-order-card-three-col article-card">
                
                <!-- LEFT COLUMN: Header + Image (35%) -->
                <div class="child-order-left-section">
                  <div class="order-header-compact">
                    <div class="flex items-start gap-2">
                      <span class="order-id">{{childOrder?.id}}</span><br>
                      <span class="order-id" *ngIf="childOrder?.originalOrderId"> Original Order ID:{{childOrder?.originalOrderId}}</span><br>
                      <span class="status-badge delivered">{{childOrder?.status}}</span>
                    </div>
                    <span class="child-order-date">{{childOrder?.date}}</span>
                  </div>
                  @for (ad of childOrder?.entries;track $index){
                  @for (media of ad.adPost?.mediaContainerData?.medias; track $index){
                    <div class="child-order-media">
                    <img src="/uploads/{{ad.adPost?.mediaContainerData?.code}}/{{media?.fileName}}" 
                          class="order-image">
                  </div>
                }
                }
                </div>
                
                <!-- MIDDLE COLUMN: Items + Description (45%) -->
                <div class="child-order-middle-section">
                  <div class="order-items-preview">
                    <div class="order-item-mini">
                      @for (ad of childOrder?.entries;track $index){
                      <div>
                        <h4 class="child-mini-item-title">{{ad?.adPost?.productName}}</h4>
                        <p class="child-mini-item-qty">Qty: 1</p>
                        <span class="child-mini-item-desc item-details-mini">
                    Owner : {{ad?.adPost?.customerData?.firstName}}<br>
                    {{ad?.adPost?.sourceAddress?.line1}}, {{ad?.adPost?.sourceAddress?.city}}<br>
                    {{ad?.adPost?.sourceAddress?.latitude}}, {{ad?.adPost?.sourceAddress?.longitude}}
                  </span>
                      </div>}
                    </div>
                  </div>
                  
                </div>
                
                <!-- RIGHT COLUMN: Price + Actions (20%) -->
                <div class="child-order-right-section">
                  <div class="child-total-price-large">{{childOrder?.price?.amount}}</div>
                  <button class="child-ord-btn ord-btn" *ngIf="childOrder.eligibleToExtend" (click)="OnSubmitExtendOrder(childOrder.id)">Extend</button>
                  <button class="child-ord-btn ord-btn" *ngIf="childOrder.returnable" (click)="OnSubmitReturnOrder(childOrder.id)">Return</button>
                  <button class="child-ord-btn ord-btn" *ngIf="childOrder.eligibleToCancel">Cancel</button>
                  <div class="order-actions">
                    <a href="/order/1245" class="view-details">View →</a>
                  </div>
                </div>
              </div>
            </div>
        }
        </div>
}


  <!-- Pagination -->
    <app-pagination
    [currentPage]="currentPage"
    [totalPages]="totalPages"
    [totalItems]="totalItems"
    [itemsPerPage]="itemsPerPage"
    (pageChange)="getOrdersByStatus($event,selectedStatus)">
  </app-pagination>
</div>